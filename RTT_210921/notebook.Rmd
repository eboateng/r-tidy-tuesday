---
title: "R Notebook"
output: html_notebook
---

```{r include=FALSE}
library(tidyverse)
library(data.table)
library(plotly)
```

```{r message=FALSE, warning=FALSE, include=FALSE}

tuesdata <- tidytuesdayR::tt_load('2021-09-21')
tuesdata <- tidytuesdayR::tt_load(2021, week = 39)
nominees <- as.data.table(tuesdata$nominees)
```

```{r}
nominees[, `:=`(
  clean_category = tolower(gsub('.{7}$', '', category)),
  title = tolower(title),
  producer = tolower(producer),
  distributor = tolower(distributor)

)]


nom90 <- nominees %>% filter(year >= 1990)
```


```{r Best show: Double barchart}

shows <- 
  nom90 %>% 
  group_by(title, type) %>% 
  summarise(no = n()) %>% 
  spread (type, no)

shows[is.na(shows)] <- 0

# Top 20 shows by:
# Winners
WStop20 <-  shows[order(-shows$Winner),][1:20,]




viz_dbar <- function(df, xaxis1, xaxis2, yaxis, xname1, xname2){
 fig <- plot_ly(x = xaxis1, y = yaxis, type = 'bar', orientation = 'h', name = xname1,
        marker = list(color = 'rgba(153, 153, 153, 0.6)', line = list(color = 'rgba(153, 153, 153, 1.0)', width = 3)))
 
fig <- fig %>% add_trace(x = xaxis2, name = xname2, 
                         marker = list(color = 'rgba(255, 153, 0, 0.6)', line = list(color = 'rgba(255, 153, 0, 1.0)',width = 3)))

fig <- fig %>% layout(
  barmode = 'stack',
  xaxis = list(title = ""),
  yaxis = list(categoryarray = xaxis1, categoryorder = "array"))

fig 
}

viz_dbar(WStop20,WStop20$Nominee, WStop20$Winner, WStop20$title, "Nominee", "Winner")

```

```{r Best show: }



```